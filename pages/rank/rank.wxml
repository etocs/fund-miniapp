<!--pages/rank/rank.wxml-->
<view class="container">
  <!-- ç­›é€‰å™¨ -->
  <view class="filter-bar">
    <view class="filter-item">
      <text class="filter-label">ç±»å‹ï¼š</text>
      <picker
        mode="selector"
        range="{{fundTypes}}"
        range-key="label"
        value="{{fundType}}"
        bindchange="onFundTypeChange"
      >
        <view class="picker-value">
          {{fundTypes[fundType].label || 'å…¨éƒ¨'}}
          <text class="arrow">â–¼</text>
        </view>
      </picker>
    </view>

    <view class="filter-item">
      <text class="filter-label">æ’åºï¼š</text>
      <picker
        mode="selector"
        range="{{sortTypes}}"
        range-key="label"
        value="{{sortType}}"
        bindchange="onSortTypeChange"
      >
        <view class="picker-value">
          {{sortTypes[sortType] || 'æ—¥æ¶¨è·Œå¹…'}}
          <text class="arrow">â–¼</text>
        </view>
      </picker>
    </view>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading-container" wx:if="{{loading}}">
    <loading>åŠ è½½ä¸­...</loading>
  </view>

  <!-- åŸºé‡‘åˆ—è¡¨ -->
  <view class="fund-list" wx:else>
    <view class="list-header">
      <text class="col col-name">åŸºé‡‘åç§°</text>
      <text class="col col-nav">å‡€å€¼</text>
      <text class="col col-growth">æ¶¨è·Œå¹…</text>
      <text class="col col-action">æ“ä½œ</text>
    </view>

    <view
      class="fund-item"
      wx:for="{{fundList}}"
      wx:key="code"
      bindtap="onFundTap"
      data-item="{{item}}"
    >
      <view class="col col-name">
        <view class="fund-name">{{item.name}}</view>
        <view class="fund-code">{{item.code}}</view>
      </view>
      <view class="col col-nav">
        <text>{{formatNumber(item.nav, 4)}}</text>
      </view>
      <view class="col col-growth">
        <text class="{{getChangeClass(item.dayGrowth)}}">
          {{formatPercent(item.dayGrowth)}}
        </text>
      </view>
      <view class="col col-action" catchtap="onToggleFavorite" data-item="{{item}}">
        <text class="favorite-icon">{{item.isFavorite ? 'â˜…' : 'â˜†'}}</text>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{fundList.length === 0}}">
      <view class="empty-icon">ğŸ“Š</view>
      <view class="empty-text">æš‚æ— æ•°æ®</view>
    </view>
  </view>
</view>
